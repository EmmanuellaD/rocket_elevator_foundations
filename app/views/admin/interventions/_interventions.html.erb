<%= form_tag createIntervention_path, :id=> 'intervention', multipart: true do %>

<div class="row">
    <div class="row">
    <div class="col-md-3 text-center employeeSelected">
        <label for="selectemployee">Employee assign</label>
        <select id="selectemployee" class="form-control pointer" name="selectemployee">
        <option value="">None</option>
        </select>
    </div>
     <br \>
    <div class="col-md-4 text-center customerSelect">
        <label for="selectcustomer">Customer Name</label>
        <select id="selectcustomer" class="form-control pointer" name="selectcustomer" required>
        </select>
    </div>
     <br \>
    <div class="col-md-2 text-center buildingSelect formS">
        <label for="selectbuilding">Building</label>
        <select id="selectbuilding" class="form-control pointer" name="selectbuilding" required>
        </select>
    </div>
     <br \>
    <div class="col-md-2 text-center batterySelect formS">
        <label for="selectbattery">Battery</label>
        <select id="selectbattery" class="form-control pointer" name="selectbattery" required>
        </select>
    </div>
     <br \>
    <div class="col-md-2 text-center columnSelect formS">
        <label for="selectcolumn">Column</label>
        <select id="selectcolumn" class="form-control pointer" name="selectcolumn">
        <option value="">None</option>
        </select>
    </div>
     <br \>
    <div class="col-md-2 text-center elevatorSelect formS">
        <label for="selectelevator">Elevator</label>
        <select id="selectelevator" class="form-control pointer" name="selectelevator">
        <option value="">None</option>
        </select>
    </div>
</div>
</br>
    <div class="col-md-9 text-center formS showField">
        <label for="selectdescription">Description</label>
        <input type="text" placeholder="Description here" id="selectdescription" class="form-control pointer" name="selectdescription">
    </div>
    <br \>
    <br \>
</div>
</h4>	
<div class="row">
    <div class="col-md-12 text-center">
        <button type="submit" class="btn btn-red">SUBMIT</button>
    </div>
</div>
<%end%>

<script>


// Functions to load the select dropdown fields
function customerF() {
    $("#selectcustomer").append("<option disabled selected>--Required--</option>")
    <% Customer.all.each do |customer| %>
        $("#selectcustomer").append("<option value='<%=customer.id%>'><%=customer.company_name%></option>")
    <% end %>
};
function employeeF() {
    $("#selectemployee").append("<option value='' selected>None</option>")
    <% Employee.all.each do |employee| %>
        $("#selectemployee").append("<option value='<%=employee.id%>'><%=employee.first_name%> <%=employee.last_name%></option>")
    <% end %>
};

function buildingF() {
    $("#selectbuilding").append("<option disabled selected>--Required--</option>")
    <% Building.all.each do |building| %>
    if ($('#selectcustomer').val() == <%=building.customer_id%>){
        $("#selectbuilding").append("<option value='<%=building.id%>'><%=building.id%></option>")
    }
    <% end %>
};

function batteryF() {
    $("#selectbattery").append("<option disabled selected>--Required--</option>")
    <% Battery.all.each do |battery| %>
    if ($('#selectbuilding').val() == <%=battery.building_id%>){
        $("#selectbattery").append("<option value='<%=battery.id%>'>Battery #<%=battery.id%></option>")
    }
    <% end %>
};

function columnF() {
    $("#selectcolumn").append("<option value='' selected>None</option>")
    <% Column.all.each do |column| %>
    if ($('#selectbattery').val() == <%=column.battery_id%>){
        $("#selectcolumn").append("<option value='<%=column.id%>'>Column #<%=column.id%></option>")
    }
    <% end %>
};

function elevatorF() {
    $("#selectelevator").append("<option value='' selected>None</option>")
    <% Elevator.all.each do |elevator| %>
    if ($('#selectcolumn').val() == <%=elevator.column_id%>){
        $("#selectelevator").append("<option value='<%=elevator.id%>'>Elevator  #<%=elevator.id%></option>")
    }
    <% end %>
};

// functions to remove pre-populated fields

function autoRemove(arg) {
    $(arg).find('option').remove()
};

function autoRemoveAll() {
    $('#intervention').find('option').remove()

};
function clearText() {
        $('#selectdescription').val("")
    }
// On every page load, clears all and repopulates

autoRemoveAll()
clearText()
customerF()
employeeF()

$(".formS").hide()

// select fields
$('#selectcustomer').change(function(){
    autoRemove('#selectbuilding')
    autoRemove('#selectbattery')
    autoRemove('#selectcolumn')
    autoRemove('#selectelevator')
    $(".formS").hide()
    $(".buildingSelection").show()
    buildingF()
});

$('#selectbuilding').change(function(){
    autoRemove('#selectbattery')
    autoRemove('#selectcolumn')
    autoRemove('#selectelevator')
    $(".columnSelection").hide()
    $(".elevatorSelection").hide()
    $(".batterySelection").show()
    batteryF()
});

$('#selectbattery').change(function(){
    autoRemove('#selectcolumn')
    autoRemove('#selectelevator')
    $(".elevatorSelection").hide()
    $(".columnSelection").show()
    columnF()
});

$('#selectcolumn').change(function(){
    autoRemove('#selectelevator')
    $(".elevatorSelection").show()
    elevatorF()
});

</script>